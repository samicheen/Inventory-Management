<div class="container-fluid">
  <div class="tabs-wrapper">
    <tabset *ngIf="!route.snapshot.params.item_id" #tabset>
      <tab heading="Main Items" (selectTab)="onSelect($event)"></tab>
      <tab heading="Sub Items" (selectTab)="onSelect($event)"></tab>
    </tabset>
  </div>
  <app-data-grid
      [columns]="columns"
      [data]="inventory"
      [showSearch]="true"
      [showActions]="true"
      [headerActions]="true"
      [actionsTemplate]="actionsTemplate"
      [trackByFn]="trackByInventoryId"
      [rowClassFn]="getRowClass"
      searchPlaceholder="Search inventory...">
      <div headerCenter>
        <div class="summary-inline" *ngIf="total">
          <span class="summary-inline-label" *ngIf="!route.snapshot.params.item_id && currentTab === 'Main Items'">Opening:</span>
          <span class="summary-inline-value" *ngIf="!route.snapshot.params.item_id && currentTab === 'Main Items'">Rs. {{total?.main_items?.opening_amount | number:'1.2-2'}}</span>
          <span class="summary-inline-separator" *ngIf="!route.snapshot.params.item_id && currentTab === 'Main Items'">|</span>
          <span class="summary-inline-label" *ngIf="!route.snapshot.params.item_id && currentTab === 'Main Items'">Closing:</span>
          <span class="summary-inline-value" *ngIf="!route.snapshot.params.item_id && currentTab === 'Main Items'">Rs. {{total?.main_items?.closing_amount | number:'1.2-2'}}</span>
          
          <span class="summary-inline-label" *ngIf="!route.snapshot.params.item_id && currentTab === 'Sub Items'">Opening:</span>
          <span class="summary-inline-value" *ngIf="!route.snapshot.params.item_id && currentTab === 'Sub Items'">Rs. {{total?.sub_items?.opening_amount | number:'1.2-2'}}</span>
          <span class="summary-inline-separator" *ngIf="!route.snapshot.params.item_id && currentTab === 'Sub Items'">|</span>
          <span class="summary-inline-label" *ngIf="!route.snapshot.params.item_id && currentTab === 'Sub Items'">Closing:</span>
          <span class="summary-inline-value" *ngIf="!route.snapshot.params.item_id && currentTab === 'Sub Items'">Rs. {{total?.sub_items?.closing_amount | number:'1.2-2'}}</span>
          
          <span class="summary-inline-label" *ngIf="route.snapshot.params.item_id">Opening:</span>
          <span class="summary-inline-value" *ngIf="route.snapshot.params.item_id">Rs. {{total?.sub_items?.opening_amount | number:'1.2-2'}}</span>
          <span class="summary-inline-separator" *ngIf="route.snapshot.params.item_id">|</span>
          <span class="summary-inline-label" *ngIf="route.snapshot.params.item_id">Closing:</span>
          <span class="summary-inline-value" *ngIf="route.snapshot.params.item_id">Rs. {{total?.sub_items?.closing_amount | number:'1.2-2'}}</span>
        </div>
      </div>
      <div headerActions>
        <button type="button"
                class="btn btn-primary btn-sm"
                (click)=addItem()>
          <i class="fa fa-plus"></i> Add Item
        </button>
      </div>
  </app-data-grid>

  <!-- Barcode Template -->
  <ng-template #barcodeTemplate let-row let-value="value">
    <span *ngIf="row.barcode || row.source_barcode">
      <i class="fa fa-barcode"></i> {{row.barcode || row.source_barcode}}
    </span>
    <span *ngIf="!row.barcode && !row.source_barcode" class="text-muted">-</span>
  </ng-template>

  <!-- Item Name Template -->
  <ng-template #itemNameTemplate let-row let-value="value">
    <a *ngIf="!route.snapshot.params.item_id" [routerLink]="['/inventory', row.item.item_id]">{{value}}</a>
    <span *ngIf="route.snapshot.params.item_id">{{value}}</span>
  </ng-template>

  <!-- Actions Template -->
  <ng-template #actionsTemplate let-inv_item>
    <div class="btn-group" dropdown [container]="'body'" [autoClose]="true">
      <button id="button-split" type="button" dropdownToggle class="btn"
              aria-controls="dropdown-split">
              <i class="fa fa-ellipsis-v"></i>
      </button>
      <ul id="dropdown-split" *dropdownMenu class="dropdown-menu dropdown-menu-right"
          role="menu" aria-labelledby="button-split">
        <li role="menuitem"><a class="dropdown-item" (click)="printLabels(inv_item)"><i class="fa fa-print"></i> Print Labels</a></li>
        <li role="menuitem"><a class="dropdown-item" (click)="moveToManufacturing(inv_item)"><i class="fa fa-industry"></i> Move to Manufacturing</a></li>
        <li role="menuitem"><a class="dropdown-item" (click)="sellItem(inv_item)"><i class="fa fa-shopping-bag"></i> Sell Item</a></li>
        <li role="menuitem" *ngIf="authService.isAdmin()"><a class="dropdown-item text-danger" (click)="removeInventory(inv_item)"><i class="fa fa-trash"></i> Remove</a></li>
      </ul>
    </div>
  </ng-template>
</div>